<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–°—Ç–∞–≤–∫–∏ –æ—Ç AI</title>
    <!-- –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.3): –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—É—Å—Ç–∞—è –∏–∫–æ–Ω–∫–∞, —á—Ç–æ–±—ã —É–±—Ä–∞—Ç—å –æ—à–∏–±–∫—É 404 –≤ –ª–æ–≥–∞—Ö -->
    <link rel="icon" href="data:;base64,iVBORw0KGgo=">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: #1c2738;
            color: white;
            text-align: center;
            padding: 20px;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            min-height: 100vh;
            box-sizing: border-box;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 350px;
            margin-bottom: 30px;
        }
        h1 {
            font-weight: 500;
            margin: 0;
            font-size: 22px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞ —è–∑—ã–∫–æ–≤ */
        .language-select {
            position: relative;
            cursor: pointer;
            border: 1px solid #313d4f;
            background-color: #1c2738;
            border-radius: 8px;
            min-width: 90px;
        }
        .selected-language {
            display: flex;
            align-items: center;
            padding: 6px 12px;
            gap: 8px;
            font-weight: bold;
        }
        .arrow-down {
            width: 0;
            height: 0;
            border-left: 4px solid transparent;
            border-right: 4px solid transparent;
            border-top: 5px solid white;
            margin-left: auto;
        }
        .language-options {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background-color: #313d4f;
            border-radius: 8px;
            margin-top: 5px;
            overflow: hidden;
            z-index: 10;
        }
        .language-options.show {
            display: block;
        }
        .language-option {
            padding: 10px 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .language-option:hover {
            background-color: #4a586e;
        }
        .flag-icon {
            width: 24px;
            height: 16px;
            border-radius: 3px;
            object-fit: cover;
        }

        .content-area {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
        }
        .button {
            width: 100%;
            max-width: 350px;
            padding: 18px;
            border-radius: 12px;
            font-size: 17px;
            font-weight: bold;
            cursor: pointer;
            border: none;
            box-sizing: border-box;
            transition: background-color 0.2s, margin-bottom 0.2s, margin-top 0.2s; /* –ü–ª–∞–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –¥–ª—è –∫–Ω–æ–ø–æ–∫ */
        }
        .upload-container {
            width: 100%;
            max-width: 350px;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 15px;
        }
        .upload-hint {
            font-size: 13px;
            color: #8a96a8;
            margin-top: 10px;
        }
        .primary-button {
            background-color: #00e676;
            color: #1c2738;
            margin-bottom: 15px;
        }
        .primary-button:disabled {
            background-color: #313d4f;
            color: #8a96a8;
            cursor: not-allowed;
            opacity: 0.6;
        }
        .secondary-button {
            background-color: #313d4f;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .secondary-button:disabled {
            background-color: #313d4f;
            color: #8a96a8;
            cursor: not-allowed;
            opacity: 0.6;
        }
        select.button {
            margin-bottom: 15px;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-color: #313d4f;
            color: white;
            padding-left: 20px;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='white'%3e%3cpath d='M8,11L2,5h12L8,11z'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 1em;
        }
        select.button:invalid {
             color: #8a96a8;
        }
        select.button option {
            background: #1c2738;
            color: white;
            font-weight: normal;
        }
        input[type="file"] {
            display: none;
        }
        .uploaded-image-container {
            margin-bottom: 20px;
            max-width: 100%;
            display: flex;
            justify-content: center;
        }
        .uploaded-image {
            max-width: 220px;
            max-height: 220px;
            border-radius: 8px;
            object-fit: contain;
            border: 1px solid #00e676;
        }
        .attempts-text {
            width: 100%;
            max-width: 350px;
            background-color: #2a3649;
            padding: 15px;
            border-radius: 12px;
            box-sizing: border-box;
            margin-top: 0;
            margin-bottom: 20px; /* –û—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É */
            /* –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.3 –¢–ó): –°—Ç–∏–ª–∏ –¥–ª—è —Ç–∞–π–º–µ—Ä–∞ */
            font-size: 14px;
            line-height: 1.5;
        }
        .attempts-error {
            background-color: #e53935; /* –ö—Ä–∞—Å–Ω—ã–π */
            color: white;
            font-weight: 500;
        }
        .footer-text {
            font-size: 12px;
            color: #888;
            padding-top: 20px;
            margin-bottom: 5px; /* –£–º–µ–Ω—å—à–µ–Ω –æ—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É */
        }
        /* –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.5): –°—Ç–∏–ª–∏ –¥–ª—è —Å—Å—ã–ª–∫–∏ –≤ —Ñ—É—Ç–µ—Ä–µ */
        .footer-link {
            font-size: 12px;
            color: #a0b0c8;
            margin-top: 0;
        }
        .footer-link a {
            color: #a0b0c8;
            text-decoration: underline;
        }
        .hidden {
            display: none !important;
        }

        /* --- –°–¢–ò–õ–ò: –≠–ö–†–ê–ù –ó–ê–ì–†–£–ó–ö–ò --- */
        .analysis-container {
            width: 100%;
            max-width: 350px;
            margin-bottom: 15px;
        }
        #analysisStatusText {
            font-size: 14px;
            color: #a0b0c8;
            height: 20px;
        }
        .progress-bar {
            width: 100%;
            background-color: #313d4f;
            border-radius: 8px;
            height: 8px;
            margin-top: 10px;
            overflow: hidden;
        }
        .progress-bar-inner {
            width: 100%;
            height: 100%;
            background-color: #00e676;
            animation: loading-progress 2s linear infinite;
        }
        @keyframes loading-progress {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* --- –°–¢–ò–õ–ò: –†–ï–ó–£–õ–¨–¢–ê–¢–´ --- */
        .results-container {
            width: 100%;
            max-width: 350px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
            margin-bottom: 15px;
        }
        .result-card {
            background-color: #2a3649;
            border-radius: 12px;
            padding: 15px;
            text-align: left;
        }
        .result-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 15px;
        }
        .result-card-header > div {
            flex: 1;
        }

        .card-title {
            font-size: 12px;
            color: #8a96a8;
            margin-bottom: 5px;
        }
        .confidence-value {
            font-size: 28px;
            font-weight: bold;
            color: #00e676;
        }
        .signal-value {
            font-size: 16px;
            font-weight: bold;
        }

        .result-card-header .info-block:first-child {
            border-right: 1px solid #4a586e;
            padding-right: 15px;
        }
        .event-list .event-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }
        .event-list .event-item:last-child {
            margin-bottom: 0;
        }
        .event-name {
            font-size: 14px;
            flex-basis: 55%;
        }
        .event-progress-container {
            flex-basis: 30%;
            background-color: #1c2738;
            height: 8px;
            border-radius: 4px;
        }
        .event-progress-bar {
            height: 100%;
            background-color: #00e676;
            border-radius: 4px;
        }
        .percentage-profit-container {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            flex-basis: 15%;
            text-align: right;
        }
        .event-percentage {
            font-size: 14px;
            font-weight: bold;
        }
        .profit-value {
            font-size: 11px;
            color: #00e676;
            font-weight: 500;
        }
        .profit-header {
            font-size: 14px;
            color: #a0b0c8;
            margin-top: 10px;
            margin-bottom: -5px;
            width: 100%;
            max-width: 350px;
            text-align: left;
        }
        .analytics-title {
            font-size: 12px;
            color: #a96a8;
            margin-bottom: 8px;
        }
        .analytics-text {
            font-size: 14px;
            line-height: 1.5;
        }
        .analytics-text b {
            color: #00e676;
        }

        .custom-alert {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #e53935; /* –ö—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç –¥–ª—è –æ—à–∏–±–∫–∏ */
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            z-index: 1000;
            font-size: 14px;
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            opacity: 1;
            transition: opacity 0.3s ease-out, top 0.3s ease-out;
        }
        .custom-alert.hidden {
            opacity: 0;
            top: 0;
            pointer-events: none;
        }
        
        /* –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.4): –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(28, 39, 56, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        .modal-overlay.show {
            opacity: 1;
            pointer-events: auto;
        }
        .modal-content {
            background: #2a3649;
            border-radius: 16px;
            padding: 25px;
            width: 90%;
            max-width: 350px;
            box-shadow: 0 5px 25px rgba(0,0,0,0.2);
            text-align: left;
        }
        .modal-content h2 {
            font-size: 20px;
            margin-top: 0;
            margin-bottom: 15px;
            text-align: center;
        }
        .modal-content p {
            font-size: 14px;
            line-height: 1.5;
            color: #a0b0c8;
            margin-bottom: 20px;
        }
        .modal-content p a {
            color: #00e676;
            text-decoration: none;
        }
        .checkbox-container {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            /* –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.2 –¢–ó): –£–±–∏—Ä–∞–µ–º –∫—É—Ä—Å–æ—Ä —Å–æ –≤—Å–µ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
            /* cursor: pointer; */ 
        }
        .checkbox-container input {
            display: none;
        }
        .custom-checkbox {
            width: 20px;
            height: 20px;
            background: #1c2738;
            border: 1px solid #4a586e;
            border-radius: 6px;
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s, border-color 0.2s;
            /* –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.2 –¢–ó): –î–µ–ª–∞–µ–º —Å–∞–º —á–µ–∫–±–æ–∫—Å –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–º */
            cursor: pointer;
        }
        .custom-checkbox svg {
            display: none;
            width: 14px;
            height: 14px;
            stroke: #1c2738;
            stroke-width: 3;
        }
        .checkbox-container input:checked + .custom-checkbox {
            background: #00e676;
            border-color: #00e676;
        }
        .checkbox-container input:checked + .custom-checkbox svg {
            display: block;
        }
        .checkbox-container label {
            font-size: 14px;
            color: #fff;
            flex: 1;
            /* –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.2 –¢–ó): –£–±–∏—Ä–∞–µ–º –∫—É—Ä—Å–æ—Ä —Å —Ç–µ–∫—Å—Ç–∞ */
            /* cursor: pointer; */
        }

    </style>
</head>
<body>
    <!-- –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.4): HTML –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ -->
    <div id="agreementModal" class="modal-overlay">
        <div class="modal-content">
            <h2 id="agreementTitle">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ</h2>
            <p id="agreementText">
                –ü–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–æ—Ç–∞ –≤—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–æ—á–µ—Å—Ç—å –∏ –ø—Ä–∏–Ω—è—Ç—å 
                <a href="https://telegra.ph/Polzovatelskoe-soglashenie-OddsAIBot-10-28" target="_blank" rel="noopener noreferrer">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ</a>.
            </p>
            <div class="checkbox-container">
                <input type="checkbox" id="agreementCheckbox">
                <!-- –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.2 –¢–ó): Span —Ç–µ–ø–µ—Ä—å –±—É–¥–µ—Ç –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–º (—Å–º. JS) -->
                <span class="custom-checkbox">
                    <svg viewBox="0 0 24 24">
                        <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                </span>
                <!-- –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.2 –¢–ó): –£–±—Ä–∞–Ω 'for', —á—Ç–æ–±—ã —Ç–µ–∫—Å—Ç –Ω–µ –±—ã–ª –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–º -->
                <label id="agreementCheckboxLabel">–Ø —Å–æ–≥–ª–∞—Å–µ–Ω —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è–º–∏</label>
            </div>
            <button id="agreementButton" class="button primary-button" disabled>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
        </div>
    </div>

    <div class="header">
        <h1>üí° –°—Ç–∞–≤–∫–∏ –æ—Ç AI</h1>
        <div class="language-select">
            <div class="selected-language">
                <img id="selectedLangFlag" class="flag-icon" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 9 6'%3E%3Crect fill='%23fff' width='9' height='3'/%3E%3Crect fill='%23d52b1e' y='3' width='9' height='3'/%3E%3Crect fill='%230039a6' y='2' width='9' height='2'/%3E%3C/svg%3E" alt="Russian Flag">
                <span id="selectedLangText">RU</span>
                <span class="arrow-down"></span>
            </div>
            <div class="language-options">
                <div class="language-option" data-lang="ru">
                    <img class="flag-icon" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 9 6'%3E%3Crect fill='%23fff' width='9' height='3'/%3E%3Crect fill='%23d52b1e' y='3' width='9' height='3'/%3E%3Crect fill='%230039a6' y='2' width='9' height='2'/%3E%3C/svg%3E" alt="Russian Flag">
                    <span>RU</span>
                </div>
                <div class="language-option" data-lang="en">
                    <img class="flag-icon" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 60 30'%3E%3CclipPath id='s'%3E%3Cpath d='M0,0 v30 h60 v-30 z'/%3E%3C/clipPath%3E%3Cpath d='M0,0 v30 h60 v-30 z' fill='%2300247d'/%3E%3Cpath d='M60,0 L0,30 M0,0 L60,30' stroke='%23fff' stroke-width='6' clip-path='url(%23s)'/%3E%3Cpath d='M60,0 L0,30 M0,0 L60,30' stroke='%23cf142b' stroke-width='4' clip-path='url(%23s)'/%3E%3Cpath d='M30,0 v30 M0,15 h60' stroke='%23fff' stroke-width='10'/%3E%3Cpath d='M30,0 v30 M0,15 h60' stroke='%23cf142b' stroke-width='6'/%3E%3C/svg%3E" alt="British Flag">
                    <span>EN</span>
                </div>
                <!-- –ò–ó–ú–ï–ù–ï–ù–ò–ï: –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ —è–∑—ã–∫–∏ (–ó–∞–¥–∞—á–∞ 2) -->
                <div class="language-option" data-lang="hi">
                    <img class="flag-icon" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 9 6'%3E%3Crect fill='%23FF9933' width='9' height='2'/%3E%3Crect fill='%23FFFFFF' y='2' width='9' height='2'/%3E%3Crect fill='%23138808' y='4' width='9' height='2'/%3E%3C/svg%3E" alt="Hindi Flag">
                    <span>HI</span>
                </div>
                <!-- –ò–ó–ú–ï–ù–ï–ù–ò–ï: –£–¥–∞–ª–µ–Ω—ã —è–∑—ã–∫–∏ ZH, LV, DE —Å–æ–≥–ª–∞—Å–Ω–æ –ó–∞–¥–∞—á–µ 1 -->
                <!-- –ö–û–ù–ï–¶ –ò–ó–ú–ï–ù–ï–ù–ò–Ø -->
            </div>
        </div>
    </div>

    <div class="content-area">

        <select id="gameType" class="button">
            <option value="" disabled selected>–¢–∏–ø –∏–≥—Ä—ã</option>
            <option value="football">–§—É—Ç–±–æ–ª</option>
            <option value="basketball">–ë–∞—Å–∫–µ—Ç–±–æ–ª</option>
            <!-- –ò–ó–ú–ï–ù–ï–ù–ò–ï: –ö—Ä–∏–∫–µ—Ç –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω –Ω–∞ 3 –º–µ—Å—Ç–æ —Å–æ–≥–ª–∞—Å–Ω–æ –ó–∞–¥–∞—á–µ 2 -->
            <option value="cricket">–ö—Ä–∏–∫–µ—Ç</option>
            <option value="tennis">–¢–µ–Ω–Ω–∏—Å</option>
            <option value="hockey">–•–æ–∫–∫–µ–π</option>
            <option value="volleyball">–í–æ–ª–µ–π–±–æ–ª</option>
            <option value="boxing">–ë–æ–∫—Å</option>
            <option value="mma">MMA</option>
            <option value="ufc">UFC</option>
            <option value="table-tennis">–ù–∞—Å—Ç–æ–ª—å–Ω—ã–π —Ç–µ–Ω–Ω–∏—Å</option>
            <option value="baseball">–ë–µ–π—Å–±–æ–ª</option>
            <option value="handball">–ì–∞–Ω–¥–±–æ–ª</option>
            <option value="rugby">–†–µ–≥–±–∏</option>
            <option value="dota2">Dota 2</option>
            <option value="cs2">CS2</option>
        </select>

        <div id="resultsContainer" class="results-container hidden">
            </div>

        <div id="imagePreview" class="uploaded-image-container hidden">
            <img class="uploaded-image" src="" alt="–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è">
        </div>

        <div id="uploadContainer" class="upload-container">
            <label for="imageUpload" id="uploadLabel" class="button secondary-button">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;"><path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path></svg>
                –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
            </label>
            <p class="upload-hint">–ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –≤—Å—Ç–∞–≤—å—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç (Ctrl + V)</p>
        </div>
        <input type="file" id="imageUpload" accept="image/*">

        <button id="analyzeButton" class="button primary-button" disabled>üîç –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞–≤–∫—É</button>

        <div id="analysisContainer" class="analysis-container hidden">
            <p id="analysisStatusText">–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º...</p>
            <div class="progress-bar">
                <div class="progress-bar-inner"></div>
            </div>
        </div>

        <button id="tryAgainButton" class="button secondary-button hidden" style="margin-bottom: 15px;">üîÑ –í—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</button>

        <p id="attemptsText" class="attempts-text">–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ø—ã—Ç–æ–∫...</p>
    </div>

    <!-- –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.5): –û–±–Ω–æ–≤–ª–µ–Ω —Ç–µ–∫—Å—Ç —Ñ—É—Ç–µ—Ä–∞ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ -->
    <p class="footer-text">–°–æ–∑–¥–∞–Ω–æ –Ω–µ–π—Ä–æ—Å–µ—Ç—å—é OddsAIBot - ¬© 2026</p>
    <p class="footer-link">
        <a href="https://telegra.ph/Polzovatelskoe-soglashenie-OddsAIBot-10-28" target="_blank" rel="noopener noreferrer" id="footerAgreementLink">
            –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ
        </a>
    </p>
    <!-- --------------------------------------------------- -->

    <div id="customAlert" class="custom-alert hidden"></div>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        const BACKEND_URL = 'https://wergune.duckdns.org';
        const MY_CUSTOM_PROMPT = "–ê–Ω–∞–ª–∏–∑–∏—Ä—É–π —Å—Ç–∞–≤–∫–∏ —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –∫–∞–ø–ø–µ—Ä–∞. –ë—É–¥—å –∫—Ä–∞—Ç–æ–∫, –Ω–æ —É–±–µ–¥–∏—Ç–µ–ª–µ–Ω.";
        
        // [–ò–ó–ú–ï–ù–ï–ù–ò–ï]: –£–¥–∞–ª–µ–Ω–∞ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ AGREEMENT_URL
        
        // –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ó–ê–î–ê–ß–ê 30.10): –ö–∞—Ä—Ç–∞ —Å—Å—ã–ª–æ–∫ –¥–ª—è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è
        // –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞-–æ–±—ä–µ–∫—Ç agreementLinks
        // –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ó–∞–¥–∞—á–∞ 1): –£–¥–∞–ª–µ–Ω—ã zh, lv, de
        const agreementLinks = {
            'ru': 'https://telegra.ph/Polzovatelskoe-soglashenie-OddsAIBot-10-28',
            'en': 'https://telegra.ph/OddsAIBot-User-Agreement-10-30',
            'hi': 'https://telegra.ph/%E0%A4%91%E0%A4%A1%E0%A4%B8%E0%A4%8F%E0%A4%86%E0%A4%88%E0%A4%AC%E0%A4%9F-%E0%A4%89%E0%A4%AA%E0%A4%AF%E0%A4%97%E0%A4%95%E0%A4%B0%E0%A4%A4-%E0%A4%85%E0%A4%A8%E0%A4%AC%E0%A4%A7-10-30',
        };
        // [–ö–û–ù–ï–¶ –ò–ó–ú–ï–ù–ï–ù–ò–Ø]

        let currentLang = 'ru'; 
        let attemptsLeft = -1; 
        let totalAttempts = 10;
        let isAnalyzing = false;
        let userId = null;
        let currentPartner = '1win'; 
        // –ò–ó–ú–ï–ù–ï–ù–ò–ï: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –æ–ø–ª–∞—Ç—ã (cpa –∏–ª–∏ revshare)
        let currentPaymentModel = 'cpa'; // –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        
        // –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.3 –¢–ó): –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ç–∞–π–º–µ—Ä–∞
        let countdownInterval = null; // –•—Ä–∞–Ω–∏—Ç ID –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞
        let cooldownEndTime = null; // –•—Ä–∞–Ω–∏—Ç ISO —Å—Ç—Ä–æ–∫—É –≤—Ä–µ–º–µ–Ω–∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∫—É–ª–¥–∞—É–Ω–∞

        // –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ó–∞–¥–∞—á–∞ 1): –£–¥–∞–ª–µ–Ω—ã –∫–ª—é—á–∏ zh, lv, de –∏–∑ translations
		const translations = {
            'ru': {
                'title': 'üí° –°—Ç–∞–≤–∫–∏ –æ—Ç AI',
                'gameType': '–¢–∏–ø –∏–≥—Ä—ã',
                // –ò–°–ü–û–õ–¨–ó–£–ï–ú –û–ë–†–ê–¢–ù–´–ï –ö–ê–í–´–ß–ö–ò (`) –ß–¢–û–ë–´ –ò–ó–ë–ï–ñ–ê–¢–¨ –û–®–ò–ë–û–ö –° WIDTH
                'uploadLabel': `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;"><path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path></svg> –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è`,
                'uploadHint': '–ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –≤—Å—Ç–∞–≤—å—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç (Ctrl + V)',
                'analyzeButton': 'üîç –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞–≤–∫—É',
                'analyzeButtonLoading': '‚è≥ –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º...',
                'tryAgainButton': 'üîÑ –í—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ',
                'attemptsTextLoading': '–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ø—ã—Ç–æ–∫...',
                'attemptsTextError': '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ø—ã—Ç–æ–∫',
                'attemptsText': '–û—Å—Ç–∞–ª–æ—Å—å –ø–æ–ø—ã—Ç–æ–∫ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è: {left} –∏–∑ {total}',
                'attemptsTimer': '–ü–æ–ø—ã—Ç–∫–∏ –æ–±–Ω–æ–≤—è—Ç—Å—è —á–µ—Ä–µ–∑: <b>{h} —á {m} –º–∏–Ω</b>.',
                'attemptsResetDeposit': '–î–ª—è —Å–±—Ä–æ—Å–∞ —Ç–∞–π–º–µ—Ä–∞ - —Å–¥–µ–ª–∞–π—Ç–µ –¥–µ–ø–æ–∑–∏—Ç –≤ <b>{partner}</b>.',
                'attemptsResetWait': '–ù–æ–≤—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ç–∞–π–º–µ—Ä–∞.',
                'attemptsRefreshing': '–û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–ø—ã—Ç–∫–∏...',
                'footerText': '–°–æ–∑–¥–∞–Ω–æ –Ω–µ–π—Ä–æ—Å–µ—Ç—å—é OddsAIBot - ¬© 2026',
                'footerLinkText': '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ',
                'profit_header': '–ü—Ä–∏ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö 100$ –≤—ã –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç–µ:',
                'alert_select_image': '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è.',
                'alert_select_game_type': '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∏–≥—Ä—ã.',
                'alert_no_attempts': '–£ –≤–∞—Å –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å –ø–æ–ø—ã—Ç–∫–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è.',
                'alert_api_key_missing': 'API –∫–ª—é—á –¥–ª—è Gemini –Ω–µ —É–∫–∞–∑–∞–Ω. –ê–Ω–∞–ª–∏–∑ –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω.',
                'alert_api_error': '–û—à–∏–±–∫–∞ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –∏–ª–∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.',
                'alert_model_overloaded': '–ù–µ–π—Ä–æ—Å–µ—Ç—å –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç.',
                'alert_backend_error': '–û—à–∏–±–∫–∞ —Å–≤—è–∑–∏ —Å —Å–µ—Ä–≤–µ—Ä–æ–º. –ü–æ–ø—ã—Ç–∫–∞ –Ω–µ –±—ã–ª–∞ —Å–ø–∏—Å–∞–Ω–∞.',
                'alert_location_not_supported': '–í–∞—à–∞ —Å—Ç—Ä–∞–Ω–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ä–∞–±–æ—Ç–æ–π –Ω–µ–π—Ä–æ—Å–µ—Ç–∏. –í–∫–ª—é—á–∏—Ç–µ VPN –¥–ª—è —Å–º–µ–Ω—ã –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è.',
                'alert_timeout': '–ù–µ–π—Ä–æ—Å–µ—Ç—å —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ –æ—Ç–≤–µ—á–∞–µ—Ç. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.',
                'alert_no_odds_detected': '–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –±—É–∫–º–µ–∫–µ—Ä—Å–∫–∏—Ö –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤.',
                'alert_agreement_required': '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–∏–º–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ.',
                'agreement_modal_title': '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ',
                'agreement_modal_text': '–ü–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–æ—Ç–∞ –≤—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–æ—á–µ—Å—Ç—å –∏ –ø—Ä–∏–Ω—è—Ç—å <a href="{url}" target="_blank" rel="noopener noreferrer">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ</a>.',
                'agreement_modal_checkbox': '–Ø —Å–æ–≥–ª–∞—Å–µ–Ω —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è–º–∏',
                'agreement_modal_button': '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å',
                'analyze_prompt': 'Analyze this bet on {gameType}.',
                'system_prompt': `You are BetGPT, an AI Analyst.

**Task 1: Validate Image**
1.  Examine the screenshot. Does it contain odds (numbers like 1.30, 5.50)?
2.  **IF NO**: Return ONLY this JSON: \`{"error": "no_odds_detected"}\`.
3.  **IF YES**: Proceed to analysis.

**Task 2: Analysis and JSON Response**
1.  Find 3-4 main markets (e.g., "Match Result", "Total").
2.  For each market, pick ONE most likely outcome and **find its odd** on the screenshot.
3.  Estimate the probability of each outcome in percent.
4.  **Format the JSON response STRICTLY according to these rules**:

* **\`events\`**: An array of objects. For **EVERY** event, you **MUST** find its odd and include it in the "name" field in parentheses. Example: \`[{"name": "–¢–æ—Ç–∞–ª –ë–æ–ª—å—à–µ 2.5 (1.85)", "probability": 75}, {"name": "–†–µ–∑—É–ª—å—Ç–∞—Ç –º–∞—Ç—á–∞: –ü1 (2.10)", "probability": 48}]\`. If you cannot find an odd for an event, DO NOT include that event in the list.
* **\`signal\`**: **STRICTLY ONLY THE NAME** of the outcome with the highest probability (without the odd). Example: "–§–æ—Ä–∞ –§–µ–Ω–µ—Ä–±–∞—Ö—á–µ +10.5". **FORBIDDEN** to add any other text or explanations here.
* **\`confidence\`**: **ONLY THE NUMBER** of the probability from the \`signal\` field.
* **\`analytics\`**: A **DETAILED ANALYSIS** of the 'signal' outcome in 2-3 sentences. Explain the reasoning. **FORBIDDEN** to repeat the outcome name in this field.

${MY_CUSTOM_PROMPT ? `Additional instruction: "${MY_CUSTOM_PROMPT}".` : ''}

**IMPORTANT: All text values in your final JSON output (like 'signal', 'analytics', and 'name' inside 'events') MUST be in the RUSSIAN language.**`,
                'analysis_steps': [
                    '–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ...',
                    '–°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ –∫–æ–º–∞–Ω–¥–∞—Ö...',
                    '–ü—Ä–æ–≤–æ–¥–∏–º –ò–ò –∞–Ω–∞–ª–∏–∑...',
                    '–í—ã—Å—á–∏—Ç—ã–≤–∞–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏...'
                ],
                'results_confidence': '–£–í–ï–†–ï–ù–ù–û–°–¢–¨ AI',
                'results_signal': '–ù–ê–î–Å–ñ–ù–´–ô –°–ò–ì–ù–ê–õ',
                'results_events': '% –°–û–ë–´–¢–ò–ô',
                'results_analytics': '–ê–ò –ê–ù–ê–õ–ò–¢–ò–ö–ê',
                'gameTypes': {
                    'football': '–§—É—Ç–±–æ–ª', 'basketball': '–ë–∞—Å–∫–µ—Ç–±–æ–ª', 'tennis': '–¢–µ–Ω–Ω–∏—Å',
                    'hockey': '–•–æ–∫–∫–µ–π', 'volleyball': '–í–æ–ª–µ–π–±–æ–ª', 'boxing': '–ë–æ–∫—Å',
                    'mma': 'MMA', 'ufc': 'UFC', 'table-tennis': '–ù–∞—Å—Ç–æ–ª—å–Ω—ã–π —Ç–µ–Ω–Ω–∏—Å',
                    'baseball': '–ë–µ–π—Å–±–æ–ª', 'handball': '–ì–∞–Ω–¥–±–æ–ª', 'rugby': '–†–µ–≥–±–∏',
                    'cricket': '–ö—Ä–∏–∫–µ—Ç', 'dota2': 'Dota 2', 'cs2': 'CS2'
                }
            },
            'en': {
                'title': 'üí° AI Bets',
                'gameType': 'Game Type',
                // –ò–°–ü–û–õ–¨–ó–£–ï–ú –û–ë–†–ê–¢–ù–´–ï –ö–ê–í–´–ß–ö–ò (`)
                'uploadLabel': `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;"><path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path></svg> Upload event image`,
                'uploadHint': 'Or just paste a screenshot (Ctrl + V)',
                'analyzeButton': 'üîç Analyze bet',
                'analyzeButtonLoading': '‚è≥ Analyzing...',
                'tryAgainButton': 'üîÑ Choose another image',
                'attemptsTextLoading': 'Loading attempts...',
                'attemptsTextError': 'Failed to load attempts',
                'attemptsText': 'Attempts left today: {left} of {total}',
                'attemptsTimer': 'Attempts will refresh in: <b>{h}h {m}m</b>.',
                'attemptsResetDeposit': 'To reset the timer - make a deposit on <b>{partner}</b>.',
                'attemptsResetWait': 'New attempts will be available after the timer ends.',
                'attemptsRefreshing': 'Refreshing attempts...',
                'footerText': 'Created by OddsAIBot neural network - ¬© 2026',
                'footerLinkText': 'User Agreement',
                'profit_header': 'With a $100 bet, you will earn:',
                'alert_select_image': 'Please upload an event image first.',
                'alert_select_game_type': 'Please select a game type first.',
                'alert_no_attempts': 'You have no attempts left for today.',
                'alert_api_key_missing': 'Gemini API key is not provided. Analysis is not possible.',
                'alert_api_error': 'Error during analysis. Please check the console or try again later.',
                'alert_model_overloaded': 'The neural network is overloaded. Please try again in 5 minutes.',
                'alert_backend_error': 'Server communication error. Attempt was not used.',
                'alert_location_not_supported': 'Your country is not supported by the neural network. Please enable a VPN to change your location.',
                'alert_timeout': 'The neural network is taking too long to respond. Please try again.',
                'alert_no_odds_detected': 'The provided screenshot does not contain betting odds.',
                'alert_agreement_required': 'Please accept the User Agreement.',
                'agreement_modal_title': 'User Agreement',
                'agreement_modal_text': 'Before using the bot, you must read and accept the <a href="{url}" target="_blank" rel="noopener noreferrer">User Agreement</a>.',
                'agreement_modal_checkbox': 'I agree to the User Agreement',
                'agreement_modal_button': 'Continue',
                'analyze_prompt': 'Analyze this bet on {gameType}.',
                 'system_prompt': `You are BetGPT, an AI Analyst.

**Task 1: Validate Image**
1.  Examine the screenshot. Does it contain odds (numbers like 1.30, 5.50)?
2.  **IF NO**: Return ONLY this JSON: \`{"error": "no_odds_detected"}\`.
3.  **IF YES**: Proceed to analysis.

**Task 2: Analysis and JSON Response**
1.  Find 3-4 main markets (e.g., "Match Result", "Total").
2.  For each market, pick ONE most likely outcome and **find its odd** on the screenshot.
3.  Estimate the probability of each outcome in percent.
4.  **Format the JSON response STRICTLY according to these rules**:

* **\`events\`**: An array of objects. For **EVERY** event, you **MUST** find its odd and include it in the "name" field in parentheses. Example: \`[{"name": "Total Over 2.5 (1.85)", "probability": 75}, {"name": "Match Result: W1 (2.10)", "probability": 48}]\`. If you cannot find an odd for an event, DO NOT include that event in the list.
* **\`signal\`**: **STRICTLY ONLY THE NAME** of the outcome with the highest probability (without the odd). Example: "Handicap Fenerbahce +10.5". **FORBIDDEN** to add any other text or explanations here.
* **\`confidence\`**: **ONLY THE NUMBER** of the probability from the \`signal\` field.
* **\`analytics\`**: A **DETAILED ANALYSIS** of the 'signal' outcome in 2-3 sentences. Explain the reasoning. **FORBIDDEN** to repeat the outcome name in this field.

${MY_CUSTOM_PROMPT ? `Additional instruction: "${MY_CUSTOM_PROMPT}".` : ''}

**IMPORTANT: All text values in your final JSON output (like 'signal', 'analytics', and 'name' inside 'events') MUST be in the ENGLISH language.**`,
                 'analysis_steps': [
                    'Analyzing image...',
                    'Gathering team data...',
                    'Performing AI analysis...',
                    'Calculating probabilities...'
                ],
                'results_confidence': 'AI CONFIDENCE',
                'results_signal': 'RELIABLE SIGNAL',
                'results_events': '% OF EVENTS',
                'results_analytics': 'AI ANALYTICS',
                'gameTypes': {
                    'football': 'Football', 'basketball': 'Basketball', 'tennis': 'Tennis',
                    'hockey': 'Hockey', 'volleyball': 'Volleyball', 'boxing': 'Boxing',
                    'mma': 'MMA', 'ufc': 'UFC', 'table-tennis': 'Table Tennis',
                    'baseball': 'Baseball', 'handball': 'Handball', 'rugby': 'Rugby',
                    'cricket': 'Cricket', 'dota2': 'Dota 2', 'cs2': 'CS2'
                }
            },
            'hi': {
                'title': 'üí° ‡§è‡§Ü‡§à ‡§¨‡•á‡§ü‡•ç‡§∏',
                'gameType': '‡§ñ‡•á‡§≤ ‡§ï‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞',
                // –ò–°–ü–û–õ–¨–ó–£–ï–ú –û–ë–†–ê–¢–ù–´–ï –ö–ê–í–´–ß–ö–ò (`)
                'uploadLabel': `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px;"><path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path></svg> ‡§à‡§µ‡•á‡§Ç‡§ü ‡§ï‡•Ä ‡§õ‡§µ‡§ø ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç`,
                'uploadHint': '‡§Ø‡§æ ‡§¨‡§∏ ‡§è‡§ï ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§®‡§∂‡•â‡§ü ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç (Ctrl + V)',
                'analyzeButton': 'üîç ‡§¨‡•á‡§ü ‡§ï‡§æ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§ï‡§∞‡•á‡§Ç',
                'analyzeButtonLoading': '‚è≥ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...',
                'tryAgainButton': 'üîÑ ‡§¶‡•Ç‡§∏‡§∞‡•Ä ‡§õ‡§µ‡§ø ‡§ö‡•Å‡§®‡•á‡§Ç',
                'attemptsTextLoading': '‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...',
                'attemptsTextError': '‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§´‡§≤',
                'attemptsText': '‡§Ü‡§ú ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∂‡•á‡§∑ ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏: {left} ‡§Æ‡•á‡§Ç ‡§∏‡•á {total}',
                'attemptsTimer': '‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ <b>{h} ‡§ò‡§Ç‡§ü‡•á {m} ‡§Æ‡§ø‡§®‡§ü</b> ‡§Æ‡•á‡§Ç ‡§∞‡•Ä‡§´‡•ç‡§∞‡•á‡§∂ ‡§π‡•ã‡§Ç‡§ó‡•á‡•§',
                'attemptsResetDeposit': '‡§ü‡§æ‡§á‡§Æ‡§∞ ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è - <b>{partner}</b> ‡§™‡§∞ ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§',
                'attemptsResetWait': '‡§ü‡§æ‡§á‡§Æ‡§∞ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§π‡•ã‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§®‡§è ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§π‡•ã‡§Ç‡§ó‡•á‡•§',
                'attemptsRefreshing': '‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§∞‡•Ä‡§´‡•ç‡§∞‡•á‡§∂ ‡§π‡•ã ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...',
                'footerText': 'OddsAIBot ‡§®‡•ç‡§Ø‡•Ç‡§∞‡§≤ ‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§®‡§ø‡§∞‡•ç‡§Æ‡§ø‡§§ - ¬© 2026',
                'footerLinkText': '‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§∏‡§Æ‡§ù‡•å‡§§‡§æ',
                'profit_header': '$100 ‡§ï‡•Ä ‡§¨‡•á‡§ü ‡§ï‡•á ‡§∏‡§æ‡§•, ‡§Ü‡§™ ‡§ï‡§Æ‡§æ‡§è‡§Ç‡§ó‡•á:',
                'alert_select_image': '‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡§π‡§≤‡•á ‡§à‡§µ‡•á‡§Ç‡§ü ‡§ï‡•Ä ‡§õ‡§µ‡§ø ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç‡•§',
                'alert_select_game_type': '‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡§π‡§≤‡•á ‡§ñ‡•á‡§≤ ‡§ï‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ö‡•Å‡§®‡•á‡§Ç‡•§',
                'alert_no_attempts': '‡§Ü‡§ú ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§™‡§ï‡•á ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§π‡•ã ‡§ó‡§è ‡§π‡•à‡§Ç‡•§',
                'alert_api_key_missing': 'Gemini API ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§®‡§π‡•Ä‡§Ç ‡§ï‡•Ä ‡§ó‡§à ‡§π‡•à‡•§ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§∏‡§Ç‡§≠‡§µ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§',
                'alert_api_error': '‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§ï‡•á ‡§¶‡•å‡§∞‡§æ‡§® ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§ï‡§Ç‡§∏‡•ã‡§≤ ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç ‡§Ø‡§æ ‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§',
                'alert_model_overloaded': '‡§®‡•ç‡§Ø‡•Ç‡§∞‡§≤ ‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§ì‡§µ‡§∞‡§≤‡•ã‡§° ‡§π‡•à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ 5 ‡§Æ‡§ø‡§®‡§ü ‡§¨‡§æ‡§¶ ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§',
                'alert_backend_error': '‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§∏‡§Ç‡§ö‡§æ‡§∞ ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø‡•§ ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ‡•§',
                'alert_location_not_supported': '‡§Ü‡§™‡§ï‡§æ ‡§¶‡•á‡§∂ ‡§®‡•ç‡§Ø‡•Ç‡§∞‡§≤ ‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§ø‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡•ç‡§•‡§æ‡§® ‡§¨‡§¶‡§≤‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡•Ä‡§™‡•Ä‡§è‡§® ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§ï‡§∞‡•á‡§Ç‡•§',
                'alert_timeout': '‡§®‡•ç‡§Ø‡•Ç‡§∞‡§≤ ‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§¶‡•á‡§®‡•á ‡§Æ‡•á‡§Ç ‡§¨‡§π‡•Å‡§§ ‡§Ö‡§ß‡§ø‡§ï ‡§∏‡§Æ‡§Ø ‡§≤‡•á ‡§∞‡§π‡§æ ‡§π‡•à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§',
                'alert_no_odds_detected': '‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§ø‡§è ‡§ó‡§è ‡§∏‡•ç‡§ï‡•ç‡§∞‡•Ä‡§®‡§∂‡•â‡§ü ‡§Æ‡•á‡§Ç ‡§¨‡•á‡§ü‡§ø‡§Ç‡§ó ‡§ë‡§°‡•ç‡§∏ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡§Ç‡•§',
                'alert_agreement_required': '‡§ï‡•É‡§™‡§Ø‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§∏‡§Æ‡§ù‡•å‡§§‡§æ ‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ï‡§∞‡•á‡§Ç‡•§',
                'agreement_modal_title': '‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§∏‡§Æ‡§ù‡•å‡§§‡§æ',
                'agreement_modal_text': '‡§¨‡•â‡§ü ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡•á ‡§∏‡•á ‡§™‡§π‡§≤‡•á, ‡§Ü‡§™‡§ï‡•ã <a href="{url}" target="_blank" rel="noopener noreferrer">‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§∏‡§Æ‡§ù‡•å‡§§‡§æ</a> ‡§™‡§¢‡§º‡§®‡§æ ‡§î‡§∞ ‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ï‡§∞‡§®‡§æ ‡§π‡•ã‡§ó‡§æ‡•§',
                'agreement_modal_checkbox': '‡§Æ‡•à‡§Ç ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§∏‡§Æ‡§ù‡•å‡§§‡•á ‡§∏‡•á ‡§∏‡§π‡§Æ‡§§ ‡§π‡•Ç‡§Ç',
                'agreement_modal_button': '‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡•á‡§Ç',
                'analyze_prompt': 'Analyze this bet on {gameType}.',
                 'system_prompt': `You are BetGPT, an AI Analyst.

**Task 1: Validate Image**
1.  Examine the screenshot. Does it contain odds (numbers like 1.30, 5.50)?
2.  **IF NO**: Return ONLY this JSON: \`{"error": "no_odds_detected"}\`.
3.  **IF YES**: Proceed to analysis.

**Task 2: Analysis and JSON Response**
1.  Find 3-4 main markets (e.g., "Match Result", "Total").
2.  For each market, pick ONE most likely outcome and **find its odd** on the screenshot.
3.  Estimate the probability of each outcome in percent.
4.  **Format the JSON response STRICTLY according to these rules**:

* **\`events\`**: An array of objects. For **EVERY** event, you **MUST** find its odd and include it in the "name" field in parentheses. Example: \`[{"name": "‡§ü‡•ã‡§ü‡§≤ ‡§ì‡§µ‡§∞ 2.5 (1.85)", "probability": 75}, {"name": "‡§Æ‡•à‡§ö ‡§ï‡§æ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ: W1 (2.10)", "probability": 48}]\`. If you cannot find an odd for an event, DO NOT include that event in the list.
* **\`signal\`**: **STRICTLY ONLY THE NAME** of the outcome with the highest probability (without the odd). Example: "‡§π‡•à‡§Ç‡§°‡•Ä‡§ï‡•à‡§™ ‡§´‡•á‡§®‡§∞‡§¨‡§æ‡§∂ +10.5". **FORBIDDEN** to add any other text or explanations here.
* **\`confidence\`**: **ONLY THE NUMBER** of the probability from the \`signal\` field.
* **\`analytics\`**: A **DETAILED ANALYSIS** of the 'signal' outcome in 2-3 sentences. Explain the reasoning. **FORBIDDEN** to repeat the outcome name in this field.

${MY_CUSTOM_PROMPT ? `Additional instruction: "${MY_CUSTOM_PROMPT}".` : ''}

**IMPORTANT: All text values in your final JSON output (like 'signal', 'analytics', and 'name' inside 'events') MUST be in the HINDI language.**`,
                 'analysis_steps': [
                    '‡§õ‡§µ‡§ø ‡§ï‡§æ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...',
                    '‡§ü‡•Ä‡§Æ ‡§°‡•á‡§ü‡§æ ‡§è‡§ï‡§§‡•ç‡§∞ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à...',
                    '‡§è‡§Ü‡§à ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à...',
                    '‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ‡§ì‡§Ç ‡§ï‡•Ä ‡§ó‡§£‡§®‡§æ ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à...'
                ],
                'results_confidence': '‡§è‡§Ü‡§à ‡§ï‡•â‡§®‡•ç‡§´‡§ø‡§°‡•á‡§Ç‡§∏',
                'results_signal': '‡§≠‡§∞‡•ã‡§∏‡•á‡§Æ‡§Ç‡§¶ ‡§∏‡§ø‡§ó‡•ç‡§®‡§≤',
                'results_events': '‡§à‡§µ‡•á‡§Ç‡§ü‡•ç‡§∏ ‡§ï‡§æ %',
                'results_analytics': '‡§è‡§Ü‡§à ‡§è‡§®‡§æ‡§≤‡§ø‡§üICS',
                'gameTypes': {
                    'football': '‡§´‡§º‡•Å‡§ü‡§¨‡•â‡§≤', 'basketball': '‡§¨‡§æ‡§∏‡•ç‡§ï‡•á‡§ü‡§¨‡•â‡§≤', 'tennis': '‡§ü‡•á‡§®‡§ø‡§∏',
                    'hockey': '‡§π‡•â‡§ï‡•Ä', 'volleyball': '‡§µ‡•â‡§≤‡•Ä‡§¨‡•â‡§≤', 'boxing': '‡§¨‡•â‡§ï‡•ç‡§∏‡§ø‡§Ç‡§ó',
                    'mma': '‡§è‡§Æ‡§è‡§Æ‡§è', 'ufc': '‡§Ø‡•Ç‡§è‡§´‡§∏‡•Ä', 'table-tennis': '‡§ü‡•á‡§¨‡§≤ ‡§ü‡•á‡§®‡§ø‡§∏',
                    'baseball': '‡§¨‡•á‡§∏‡§¨‡•â‡§≤', 'handball': '‡§π‡•à‡§Ç‡§°‡§¨‡•â‡§≤', 'rugby': '‡§∞‡§ó‡•ç‡§¨‡•Ä',
                    'cricket': '‡§ï‡•ç‡§∞‡§ø‡§ï‡•á‡§ü', 'dota2': '‡§°‡•ã‡§ü‡§æ 2', 'cs2': '‡§∏‡•Ä‡§è‡§∏2'
                }
            }
        };

        const imageUpload = document.getElementById('imageUpload');
        const uploadContainer = document.getElementById('uploadContainer');
        const imagePreviewContainer = document.getElementById('imagePreview');
        const imagePreview = document.querySelector('#imagePreview img');
        const analyzeButton = document.getElementById('analyzeButton');
        const tryAgainButton = document.getElementById('tryAgainButton');
        const attemptsTextElement = document.getElementById('attemptsText');
        const gameTypeSelect = document.getElementById('gameType');

        const selectedLanguage = document.querySelector('.selected-language');
        const languageOptionsContainer = document.querySelector('.language-options');
        const languageOptions = document.querySelectorAll('.language-option');
        const selectedLangFlag = document.getElementById('selectedLangFlag');
        const selectedLangText = document.getElementById('selectedLangText');

        const analysisContainer = document.getElementById('analysisContainer');
        const analysisStatusText = document.getElementById('analysisStatusText');
        const resultsContainer = document.getElementById('resultsContainer');
        let analysisInterval;
        
        // –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.4): –≠–ª–µ–º–µ–Ω—Ç—ã –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        const agreementModal = document.getElementById('agreementModal');
        const agreementCheckbox = document.getElementById('agreementCheckbox');
        const agreementButton = document.getElementById('agreementButton');

        // --- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –∞–ª–µ—Ä—Ç–∞ ---
        function showCustomAlert(message) {
            const customAlert = document.getElementById('customAlert');
            customAlert.textContent = message;
            customAlert.classList.remove('hidden');

            setTimeout(() => {
                customAlert.classList.add('hidden');
            }, 3000); // –°–∫—Ä—ã–≤–∞—Ç—å —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
        }

        // --- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–∫–∏ –∞–Ω–∞–ª–∏–∑–∞ ---
        function updateAnalyzeButtonState() {
            const imageLoaded = !imagePreviewContainer.classList.contains('hidden');
            // –ö–Ω–æ–ø–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞, –µ—Å–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ò –ø–æ–ø—ã—Ç–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã (attemptsLeft !== -1) –ò (–ø–æ–ø—ã—Ç–æ–∫ > 0 –ò–õ–ò –∫—É–ª–¥–∞—É–Ω –Ω–µ –∞–∫—Ç–∏–≤–µ–Ω)
            analyzeButton.disabled = !imageLoaded || attemptsLeft === -1 || (attemptsLeft <= 0 && cooldownEndTime);
        }

        // --- –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.3 –¢–ó): –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–∞–π–º–µ—Ä–∞ ---
		function startCountdown(endTimeISO) {
            const t = translations[currentLang] || translations['ru'];
            const endTime = new Date(endTimeISO).getTime();
            
            if (countdownInterval) {
                clearInterval(countdownInterval);
            }

            function updateTimer() {
                const now = new Date().getTime();
                const distance = endTime - now;

                if (distance < 0) {
                    clearInterval(countdownInterval);
                    countdownInterval = null;
                    attemptsTextElement.textContent = t.attemptsRefreshing;
                    loadInitialAttempts(); 
                    return;
                }

                const hours = Math.floor(distance / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));

                let timerString = t.attemptsTimer
                    .replace('{h}', hours)
                    .replace('{m}', minutes);
                
                const partnerDisplayName = currentPartner.toLowerCase() === 'mostbet' ? 'Mostbet' : '1Win';
                const depositText = t.attemptsResetDeposit.replace('{partner}', partnerDisplayName);

                // --- –õ–û–ì–ò–ö–ê –¢–ï–ö–°–¢–ê –ü–û –ú–û–î–ï–õ–ò –û–ü–õ–ê–¢–´ ---
                if (currentPartner.toLowerCase() === '1win') {
                    // 1win: –í—Å–µ–≥–¥–∞ –ø—Ä–æ—Å–∏–º –¥–µ–ø–æ–∑–∏—Ç
                    timerString += `<br>${depositText}`;
                } else if (currentPartner.toLowerCase() === 'mostbet') {
                    // Mostbet: –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –º–æ–¥–µ–ª–∏
                    if (currentPaymentModel === 'cpa') {
                        // CPA = –ø—Ä–æ—Å–∏–º –¥–µ–ø–æ–∑–∏—Ç
                        timerString += `<br>${depositText}`;
                    } else {
                        // RevShare = –ø—Ä–æ—Å–∏–º –∂–¥–∞—Ç—å
                        timerString += `<br>${t.attemptsResetWait}`;
                    }
                }
                // --------------------------------------

                attemptsTextElement.innerHTML = timerString;
                attemptsTextElement.classList.remove('attempts-error');
                updateAnalyzeButtonState();
            }

            updateTimer(); 
            countdownInterval = setInterval(updateTimer, 1000); 
        }

        // --- –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.3 –¢–ó): –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –æ –ø–æ–ø—ã—Ç–∫–∞—Ö ---
        function updateAttemptsText() {
            // –ò–ó–ú–ï–ù–ï–ù–ò–ï: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ translations[currentLang]
            const t = translations[currentLang] || translations['ru'];
            
            // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–π —Ç–∞–π–º–µ—Ä, –µ—Å–ª–∏ –æ–Ω –±—ã–ª
            if (countdownInterval) {
                clearInterval(countdownInterval);
                countdownInterval = null;
            }

            if (attemptsLeft === -1) {
                // –ü–æ–ø—ã—Ç–∫–∏ –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–ª–∏ –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ (—Ç–µ–∫—Å—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ loadInitialAttempts)
            } else if (attemptsLeft === 0 && cooldownEndTime) {
                // –ü–æ–ø—ã—Ç–æ–∫ –Ω–µ—Ç, –∏ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –∫—É–ª–¥–∞—É–Ω -> –∑–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä
                startCountdown(cooldownEndTime);
            } else if (attemptsLeft >= 0) {
                // –ü–æ–ø—ã—Ç–∫–∏ –µ—Å—Ç—å (–∏–ª–∏ 0, –Ω–æ –Ω–µ—Ç –∫—É–ª–¥–∞—É–Ω–∞ - —Ä–µ–¥–∫–∏–π —Å–ª—É—á–∞–π)
                attemptsTextElement.classList.remove('attempts-error');
                attemptsTextElement.innerHTML = t.attemptsText
                    .replace('{left}', attemptsLeft)
                    .replace('{total}', totalAttempts);
            }
            updateAnalyzeButtonState();
        }

        // --- –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —è–∑—ã–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ ---
        function setLanguage(lang) {
            // –ò–ó–ú–ï–ù–ï–ù–ò–ï: –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø–µ—Ä–µ–≤–æ–¥, –∏–Ω–∞—á–µ 'ru'
            if (!translations[lang]) {
                lang = 'ru';
            }
            currentLang = lang; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
            // --- –ö–û–ù–ï–¶ –ò–ó–ú–ï–ù–ï–ù–ò–Ø ---

            const option = document.querySelector(`.language-option[data-lang="${lang}"]`);
            if (option) {
                selectedLangFlag.src = option.querySelector('.flag-icon').src;
                selectedLangText.textContent = option.querySelector('span').textContent;
            }

            // –ò–ó–ú–ï–ù–ï–ù–ò–ï: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ translations[lang]
            const t = translations[lang] || translations['ru'];
            document.querySelector('h1').innerHTML = t.title;
            document.querySelector('#gameType option[disabled]').textContent = t.gameType;
            document.getElementById('uploadLabel').innerHTML = t.uploadLabel;
            document.querySelector('.upload-hint').innerHTML = t.uploadHint;

            analyzeButton.innerHTML = isAnalyzing ? t.analyzeButtonLoading : t.analyzeButton;
            tryAgainButton.innerHTML = t.tryAgainButton;

            if (attemptsLeft === -1 && attemptsTextElement.classList.contains('attempts-error')) {
                 attemptsTextElement.textContent = t.attemptsTextError;
            } else if (attemptsLeft === -1) {
                 attemptsTextElement.textContent = t.attemptsTextLoading;
            } else {
                 updateAttemptsText(); // <-- –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è —Ç–µ–ø–µ—Ä—å —É–ø—Ä–∞–≤–ª—è–µ—Ç –∏ —Ç–∞–π–º–µ—Ä–æ–º
            }

            // [–ò–ó–ú–ï–ù–ï–ù–ò–ï]: –ë–ª–æ–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Å—ã–ª–æ–∫ –∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            // –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.5): –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —Ñ—É—Ç–µ—Ä–∞ (—Ç–æ–ª—å–∫–æ 1 —Å—Ç—Ä–æ–∫–∞)
            document.querySelector('.footer-text').textContent = t.footerText;
            
            // –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ó–ê–î–ê–ß–ê 30.10): –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è
            // –ü–æ–ª—É—á–∞–µ–º URL –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —è–∑—ã–∫–∞, —Å —Ä–µ–∑–µ—Ä–≤–Ω—ã–º –≤–∞—Ä–∏–∞–Ω—Ç–æ–º 'ru'
            const currentAgreementUrl = agreementLinks[currentLang] || agreementLinks['ru'];

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Å—ã–ª–∫—É –≤ —Ñ—É—Ç–µ—Ä–µ (–∏ —Ç–µ–∫—Å—Ç, –∏ href)
            const footerLink = document.getElementById('footerAgreementLink');
            footerLink.href = currentAgreementUrl;
            footerLink.textContent = t.footerLinkText;

            // –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.4): –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ (—Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º URL)
            document.getElementById('agreementTitle').textContent = t.agreement_modal_title;
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞, –í–°–¢–ê–í–õ–Ø–Ø –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL
            document.getElementById('agreementText').innerHTML = t.agreement_modal_text.replace('{url}', currentAgreementUrl);
            document.getElementById('agreementCheckboxLabel').textContent = t.agreement_modal_checkbox;
            document.getElementById('agreementButton').textContent = t.agreement_modal_button;
            // [–ö–û–ù–ï–¶ –ò–ó–ú–ï–ù–ï–ù–ò–Ø]

            const gameOptions = gameTypeSelect.querySelectorAll('option:not([disabled])');
            gameOptions.forEach(option => {
                const gameKey = option.value;
                if (t.gameTypes[gameKey]) {
                    option.textContent = t.gameTypes[gameKey];
                }
            });

            if (!resultsContainer.classList.contains('hidden')) {
                const confidenceTitle = resultsContainer.querySelector('.info-block:nth-child(1) .card-title');
                const signalTitle = resultsContainer.querySelector('.info-block:nth-child(2) .card-title');
                const profitHeader = resultsContainer.querySelector('.profit-header');
                const eventsTitle = resultsContainer.querySelector('.event-list .card-title');
                const analyticsTitle = resultsContainer.querySelector('.result-card:last-child .analytics-title');

                if (confidenceTitle) confidenceTitle.textContent = t.results_confidence;
                if (signalTitle) signalTitle.textContent = t.results_signal;
                if (profitHeader) profitHeader.textContent = t.profit_header;
                if (eventsTitle) eventsTitle.textContent = t.results_events;
                if (analyticsTitle) analyticsTitle.textContent = t.results_analytics;
            }
        }

        // --- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —è–∑—ã–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä ---
        async function setLanguageOnServer(lang) {
            if (!userId) {
                console.log("Cannot set lang on server: userId is missing.");
                return;
            }
            console.log(`Sending language '${lang}' to server for user ${userId}...`);
            try {
                const response = await fetch(`${BACKEND_URL}/set_lang`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'ngrok-skip-browser-warning': 'true'
                    },
                    body: JSON.stringify({ user_id: userId, lang: lang })
                });
                if (response.ok) {
                    const result = await response.json();
                    console.log("Server response for set_lang:", result.message);
                } else {
                     console.error("Failed to set language on server:", response.status);
                }
            } catch (error) {
                console.error("Error sending set_lang request:", error);
            }
        }


        // --- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–º–µ–Ω—ã —è–∑—ã–∫–∞ ---
        selectedLanguage.addEventListener('click', () => {
            languageOptionsContainer.classList.toggle('show');
        });

        languageOptions.forEach(option => {
            option.addEventListener('click', () => {
                const newLang = option.dataset.lang;
                // currentLang = newLang; // setLanguage —Ç–µ–ø–µ—Ä—å –¥–µ–ª–∞–µ—Ç —ç—Ç–æ
                setLanguage(newLang); 
                setLanguageOnServer(newLang); 
                languageOptionsContainer.classList.remove('show');
            });
        });

        window.addEventListener('click', (e) => {
            if (!document.querySelector('.language-select').contains(e.target)) {
                languageOptionsContainer.classList.remove('show');
            }
        });

        // --- –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è ---
        function showImage(file) {
            resultsContainer.classList.add('hidden'); 
            analysisContainer.classList.add('hidden'); 
            // –ò–ó–ú–ï–ù–ï–ù–ò–ï: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ translations[currentLang]
            analyzeButton.innerHTML = (translations[currentLang] || translations['ru']).analyzeButton;
            isAnalyzing = false;

            const reader = new FileReader();
            reader.onload = function(e) {
                imagePreview.src = e.target.result;
                imagePreviewContainer.classList.remove('hidden'); 
                uploadContainer.classList.add('hidden'); 

                updateAnalyzeButtonState(); 
                tryAgainButton.classList.remove('hidden'); 
            };
            reader.readAsDataURL(file);
        }

        // --- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è ---
		imageUpload.addEventListener('change', (event) => {
            if (event.target.files && event.target.files[0]) {
                // --- –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞ ---
                const file = event.target.files[0];
                if (file.type && file.type.startsWith('image/')) {
                    // –≠—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –µ–≥–æ
                    showImage(file);
                } else {
                    // –§–∞–π–ª –≤—ã–±—Ä–∞–Ω, –Ω–æ —ç—Ç–æ –ù–ï –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                    const t = translations[currentLang] || translations['ru'];
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É, —á—Ç–æ –Ω—É–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –∏–º–µ–Ω–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                    showCustomAlert(t.alert_select_image); 
                    
                    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º input, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª
                    imageUpload.value = '';
                }
                // --- –ö–û–ù–ï–¶ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø ---
            }
        });

        document.addEventListener('paste', (event) => {
            const items = (event.clipboardData || event.originalEvent.clipboardData).items;
            for (let index in items) {
                const item = items[index];
                if (item.kind === 'file' && item.type.startsWith('image/')) {
                    showImage(item.getAsFile());
                }
            }
        });

        // --- –§—É–Ω–∫—Ü–∏—è —Å–±—Ä–æ—Å–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è ---
        function resetToInitialState() {
            imageUpload.value = ''; 
            isAnalyzing = false;

            imagePreviewContainer.classList.add('hidden'); 
            resultsContainer.classList.add('hidden'); 
            analysisContainer.classList.add('hidden'); 
            uploadContainer.classList.remove('hidden'); 

            // –ò–ó–ú–ï–ù–ï–ù–ò–ï: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ translations[currentLang]
            analyzeButton.innerHTML = (translations[currentLang] || translations['ru']).analyzeButton; 
            analyzeButton.classList.remove('hidden'); 
            analyzeButton.style.marginBottom = ''; 

            tryAgainButton.classList.add('hidden'); 
            tryAgainButton.disabled = false; 
            gameTypeSelect.disabled = false; 
            gameTypeSelect.classList.remove('hidden'); 

            updateAnalyzeButtonState(); 
        }

        // --- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–í—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" ---
        tryAgainButton.addEventListener('click', resetToInitialState);


        // --- –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞ ---
        function displayResults(data) {
            // –ò–ó–ú–ï–ù–ï–ù–ò–ï: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ translations[currentLang]
            const t = translations[currentLang] || translations['ru'];

            const confidence = data.confidence || (data.events && data.events.length > 0 ? Math.max(...data.events.map(e => e.probability || 0)) : 'N/A');

            resultsContainer.innerHTML = `
                <div class="result-card">
                    <div class="result-card-header">
                        <div class="info-block">
                            <div class="card-title">${t.results_confidence}</div>
                            <div class="confidence-value">${confidence}%</div>
                        </div>
                        <div class="info-block">
                            <div class="card-title">${t.results_signal}</div>
                            <div class="signal-value">${data.signal || 'N/A'}</div>
                        </div>
                    </div>
                </div>

                <p class="profit-header">${t.profit_header}</p>

                <div class="result-card event-list">
                    <div class="card-title">${t.results_events}</div>
                    ${(data.events || []).map(event => {
                        let eventName = event.name || ''; 
                        let profitText = '';
                        const oddsMatch = eventName.match(/\(([\d.,]+)\)/);

                        if (oddsMatch && oddsMatch[1]) {
                            const odds = parseFloat(oddsMatch[1].replace(',', '.'));
                            if (!isNaN(odds) && odds > 1) {
                                const profit = (100 * (odds - 1)).toFixed(2);
                                profitText = `<span class="profit-value">+${profit}$</span>`;
                                eventName = eventName.replace(/\s*\([\d.,]+\)/, '').trim();
                            } else {
                                 eventName = eventName.replace(/\s*\([\d.,]+\)/, '').trim();
                            }
                        }

                        const probability = typeof event.probability === 'number' ? event.probability : 0;

                        return `
							<div class="event-item">
								<span class="event-name">${eventName || '–°–æ–±—ã—Ç–∏–µ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ'}</span>
								<div class="event-progress-container">
									<div class="event-progress-bar" style="width: ${probability}%;"></div>
								</div>
								<div class="percentage-profit-container">
									<span class="event-percentage">${probability}%</span>
									${profitText}
								</div>
							</div>
                        `;
                    }).join('')}
                </div>
                <div class="result-card">
                    <div class="analytics-title">${t.results_analytics}</div>
                    <p class="analytics-text">${data.analytics || '–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞.'}</p>
                </div>
            `;
            resultsContainer.classList.remove('hidden'); 
        }

        // --- –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —Å–ø–∏—Å–∞–Ω–∏–µ –ø–æ–ø—ã—Ç–∫–∏ ---
        async function sendAttemptToServer() {
            // –ò–ó–ú–ï–ù–ï–ù–ò–ï: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ translations[currentLang]
            const t = translations[currentLang] || translations['ru'];
            if (!userId) {
                console.error("User ID not found, cannot send attempt usage.");
                showCustomAlert(t.alert_backend_error); 
                return false; 
            }
             console.log(`Sending /use_attempt for user ${userId} (partner: ${currentPartner}) to ${BACKEND_URL}`);
            try {
                const response = await fetch(`${BACKEND_URL}/use_attempt`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'ngrok-skip-browser-warning': 'true'
                    },
                    body: JSON.stringify({ user_id: userId, partner: currentPartner })
                });

                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({})); 
                    console.error('Failed to send attempt usage:', response.status, errorData);
                    
                    // –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.3 –¢–ó): –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫—É–ª–¥–∞—É–Ω, –¥–∞–∂–µ –µ—Å–ª–∏ —Å–ø–∏—Å–∞–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å (–ø–æ–ø—ã—Ç–æ–∫ –Ω–µ—Ç)
                    if (errorData.cooldown_end_iso) {
                        cooldownEndTime = errorData.cooldown_end_iso;
                    }
                    attemptsLeft = 0; // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å—Ç–∞–≤–∏–º 0, —Ç.–∫. —Å–µ—Ä–≤–µ—Ä —Å–∫–∞–∑–∞–ª "–Ω–µ—Ç"
                    updateAttemptsText(); // –≠—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç —Ç–∞–π–º–µ—Ä
                    
                    showCustomAlert(errorData.error || t.alert_backend_error); 
                    return false; 
                }

                const result = await response.json();
                console.log('Attempt usage sent successfully:', result);
                if (typeof result.attempts_remaining === 'number') {
                     attemptsLeft = result.attempts_remaining; 
                     // –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.3 –¢–ó): –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫—É–ª–¥–∞—É–Ω, –µ—Å–ª–∏ –æ–Ω –ø—Ä–∏—à–µ–ª
                     cooldownEndTime = result.cooldown_end_iso || null;
                     updateAttemptsText(); // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç (–∏ –∑–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä, –µ—Å–ª–∏ attemptsLeft=0)
                }
                return true; // –£—Å–ø–µ—à–Ω–æ —Å–ø–∏—Å–∞–ª–∏
            } catch (error) {
                console.error('Network error sending attempt usage:', error);
                showCustomAlert(t.alert_backend_error); 
                return false; 
            }
        }


       // --- –§—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ —Å—Ç–∞–≤–∫–∏ (–≤—ã–∑–æ–≤ Gemini —á–µ—Ä–µ–∑ –Ω–∞—à –±—ç–∫–µ–Ω–¥) ---
       async function analyzeBet() {
            // –ò–ó–ú–ï–ù–ï–ù–ò–ï: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ translations[currentLang]
            const t = translations[currentLang] || translations['ru'];
            console.log("--- Starting Bet Analysis ---");

            if (attemptsLeft === -1) {
                showCustomAlert(t.attemptsTextError); return; 
            }
            if (gameTypeSelect.value === '') {
                showCustomAlert(t.alert_select_game_type); return;
            }
            if (!imagePreview.src || imagePreviewContainer.classList.contains('hidden')) {
                 showCustomAlert(t.alert_select_image); return;
            }
             if (attemptsLeft <= 0) {
                  // –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.3 –¢–ó): –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ —Ç–æ–ª—å–∫–æ attemptsLeft, –Ω–æ –∏ –Ω–∞–ª–∏—á–∏–µ —Ç–∞–π–º–µ—Ä–∞
                  if (cooldownEndTime) {
                      showCustomAlert(t.alert_no_attempts); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–ª–µ—Ä—Ç, –µ—Å–ª–∏ —Ç–∞–π–º–µ—Ä –∞–∫—Ç–∏–≤–µ–Ω
                  } else {
                      // –ü–æ–ø—ã—Ç–æ–∫ 0, –Ω–æ —Ç–∞–π–º–µ—Ä–∞ –Ω–µ—Ç (–æ—à–∏–±–∫–∞? –∏–ª–∏ —Ç–æ–ª—å–∫–æ —á—Ç–æ –∫–æ–Ω—á–∏–ª–∏—Å—å?)
                      // –ü–æ–ø—Ä–æ–±—É–µ–º –∑–∞–ø—Ä–æ—Å–∏—Ç—å /use_attempt, –æ–Ω –≤–µ—Ä–Ω–µ—Ç –æ—à–∏–±–∫—É –∏ –∑–∞–ø—É—Å—Ç–∏—Ç —Ç–∞–π–º–µ—Ä
                      console.log("Attempts 0, but no cooldown. Triggering use_attempt to check/start cooldown.");
                  }
                  // –í –ª—é–±–æ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ attemptsLeft <= 0, –º—ã –Ω–µ –¥–æ–ª–∂–Ω—ã –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å
                  return;
             }

            // --- –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.1): –ë–ª–æ–∫–∏—Ä—É–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –Ω–æ –ù–ï —Å–ø–∏—Å—ã–≤–∞–µ–º –ø–æ–ø—ã—Ç–∫—É ---
            isAnalyzing = true; 
            analyzeButton.innerHTML = t.analyzeButtonLoading;
            analyzeButton.disabled = true;
            tryAgainButton.disabled = true;
            gameTypeSelect.disabled = true; 
            analyzeButton.style.marginBottom = '5px';
            analysisContainer.classList.remove('hidden'); 
            // ----------------------------------------------------------------

            let step = 0;
            const steps = t.analysis_steps;
            analysisStatusText.textContent = steps[step];
            if (analysisInterval) clearInterval(analysisInterval);
            analysisInterval = setInterval(() => {
                step = (step + 1) % steps.length;
                analysisStatusText.textContent = steps[step];
            }, 2000);

            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), 30000); 

            try {
                const imageBase64_full = imagePreview.src;
                const gameTypeValue = gameTypeSelect.options[gameTypeSelect.selectedIndex].text;

                // –ò–ó–ú–ï–ù–ï–ù–ò–ï: –ò—Å–ø–æ–ª—å–∑—É–µ–º 'en' prompt –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞, –Ω–æ 'system_prompt' –Ω–∞ –Ω—É–∂–Ω–æ–º —è–∑—ã–∫–µ
                const userPromptText = translations['en'].analyze_prompt.replace('{gameType}', gameTypeValue); 
                // –ò–ó–ú–ï–ù–ï–ù–ò–ï: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ translations[currentLang]
                const systemPromptText = (translations[currentLang] || translations['ru']).system_prompt;
                // --- –ö–û–ù–ï–¶ –ò–ó–ú–ï–ù–ï–ù–ò–Ø ---


                const mimeType = imageBase64_full.split(',')[0].split(':')[1].split(';')[0];
                const base64Data = imageBase64_full.split(',')[1];

                const requestBody = {
                  contents: [ { parts: [ { text: userPromptText }, { inlineData: { mimeType: mimeType, data: base64Data } } ] } ],
                  systemInstruction: { parts: [{ text: systemPromptText }] },
                  generationConfig: {
                      responseMimeType: "application/json",
                      responseSchema: {
                          type: "OBJECT",
                          properties: {
                            "confidence": { "type": "NUMBER" }, "signal": { "type": "STRING" },
                            "events": {
                              "type": "ARRAY", "items": { "type": "OBJECT",
                                "properties": { "name": { "type": "STRING" }, "probability": { "type": "NUMBER" } },
                                "required": ["name", "probability"]
                              }
                            },
                            "analytics": { "type": "STRING" }, "error": { "type": "STRING" }
                          },
                          required: ["analytics"] 
                      }
                  }
                };

                console.log("Sending request to Backend proxy (/analyze_gemini)...");
                const apiUrl = `${BACKEND_URL}/analyze_gemini`;
                
                // --- –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.1): –®–∞–≥ 1 - –í—ã–∑–æ–≤ API Gemini (–±–µ–∑ —Å–ø–∏—Å–∞–Ω–∏—è) ---
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'ngrok-skip-browser-warning': 'true' 
                    },
                    body: JSON.stringify(requestBody),
                    signal: controller.signal
                });

                clearTimeout(timeoutId); 

                const responseText = await response.text(); 
                console.log("Raw Backend response:", responseText); 

                // --- –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.1): –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ—à–∏–±–∫–∏ –î–û —Å–ø–∏—Å–∞–Ω–∏—è ---
                if (!response.ok) {
                    let errorData = { error: { message: `Backend Proxy Error: ${response.status}` } };
                    try {
                        errorData = JSON.parse(responseText);
                         if (errorData?.error?.message?.includes("User location is not supported")) {
                             throw new Error("User location is not supported"); 
                         }
                         if (errorData?.error?.message?.toLowerCase().includes("overloaded")) {
                             throw new Error("Model is overloaded"); // <--- –ö–ª—é—á–µ–≤–∞—è –æ—à–∏–±–∫–∞
                         }
                    } catch (e) {
                         if (e.message.includes("User location") || e.message.includes("overloaded")) throw e;
                    }
                    throw new Error(errorData.error ? errorData.error.message : 'Backend network response was not ok');
                }

                let data;
                 try {
                     data = JSON.parse(responseText); 
                 } catch (e) {
                     console.error("Failed to parse Backend JSON response:", e);
                     throw new Error("Invalid JSON response from Backend.");
                 }

                if (!data.candidates?.[0]?.content?.parts?.[0]?.text) {
                    if (data?.error?.message?.includes("User location is not supported")) {
                         throw new Error("User location is not supported");
                    }
                    if (data?.error?.message?.toLowerCase().includes("overloaded")) {
                         throw new Error("Model is overloaded"); // <--- –ö–ª—é—á–µ–≤–∞—è –æ—à–∏–±–∫–∞
                    }
                    console.error("Invalid API response structure from Backend:", data);
                    throw new Error(data?.error?.message || "Invalid API response structure.");
                }
                
                // --- –ï—Å–ª–∏ –º—ã –∑–¥–µ—Å—å, Gemini –æ—Ç–≤–µ—Ç–∏–ª —É—Å–ø–µ—à–Ω–æ –∏ –ë–ï–ó –æ—à–∏–±–∫–∏ "overloaded" ---

                // --- –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.1): –®–∞–≥ 2 - –°–ø–∏—Å—ã–≤–∞–µ–º –ø–æ–ø—ã—Ç–∫—É ---
                const attemptSent = await sendAttemptToServer();
                
                if (!attemptSent) {
                    // –ï—Å–ª–∏ —Å–ø–∏—Å–∞—Ç—å –ø–æ–ø—ã—Ç–∫—É –ù–ï —É–¥–∞–ª–æ—Å—å (–æ—à–∏–±–∫–∞ –±—ç–∫–µ–Ω–¥–∞),
                    // –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º.
                    console.log("Attempt usage failed, cancelling analysis.");
                    // –û—à–∏–±–∫—É –ø–æ–∫–∞–∂–µ—Ç —Å–∞–º–∞ sendAttemptToServer()
                    throw new Error("Backend attempt error"); // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ catch
                }
                
                // --- –ï—Å–ª–∏ –º—ã –∑–¥–µ—Å—å, –ø–æ–ø—ã—Ç–∫–∞ —É—Å–ø–µ—à–Ω–æ —Å–ø–∏—Å–∞–Ω–∞ ---
                
                // --- –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.1): –®–∞–≥ 3 - –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç ---
                let results;
                const jsonText = data.candidates[0].content.parts[0].text;
                 try {
                     results = JSON.parse(jsonText);
                 } catch (e) {
                     console.error("Failed to parse inner JSON from Gemini:", e, "JSON Text:", jsonText);
                      const markdownJsonMatch = jsonText.match(/```json\s*([\s\S]*?)\s*```/);
                      if (markdownJsonMatch && markdownJsonMatch[1]) {
                          try {
                              results = JSON.parse(markdownJsonMatch[1]);
                               console.log("Successfully parsed markdown JSON.");
                          } catch (e2) {
                               console.error("Failed to parse even markdown JSON:", e2);
                               throw new Error("Invalid inner JSON format from Gemini.");
                          }
                      } else {
                           throw new Error("Invalid inner JSON format from Gemini.");
                      }
                 }

                console.log("Successfully parsed analysis results:", results);

                if (results.error === "no_odds_detected") {
                    showCustomAlert(t.alert_no_odds_detected);
                    resetToInitialState(); // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫ –Ω–∞—á–∞–ª—É
                } else {
                    displayResults(results); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                    
                    // --- –ò–ó–ó–ú–ï–ù–ï–ù–ò–ï (–ø.2): –°–∫—Ä—ã–≤–∞–µ–º –ø—Ä–µ–≤—å—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è ---
                    imagePreviewContainer.classList.add('hidden');
                    // -------------------------------------------
                    
                    analyzeButton.classList.add('hidden'); 
                    analysisContainer.classList.add('hidden'); 
                    tryAgainButton.disabled = false; 
                    gameTypeSelect.disabled = false; 
                }

            } catch (error) {
                 console.error('--- ERROR during API call ---', error);

                // --- –ò–ó–ú–ï–ù–ï–ù–ò–ï (–ø.1): –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ ---
                if (error.name === 'AbortError') {
                    showCustomAlert(t.alert_timeout);
                } else if (error?.message?.includes("User location is not supported")) {
                    showCustomAlert(t.alert_location_not_supported);
                } else if (error?.message?.toLowerCase().includes("overloaded")) { 
                    // –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ "overloaded", –ø–æ–ø—ã—Ç–∫–∞ –ù–ï –ë–´–õ–ê —Å–ø–∏—Å–∞–Ω–∞.
                    showCustomAlert(t.alert_model_overloaded); 
                } else if (error?.message?.includes("Backend attempt error")) {
                    // –û—à–∏–±–∫—É –ø–æ–∫–∞–∑–∞–ª–∞ sendAttemptToServer(), –ø—Ä–æ—Å—Ç–æ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º UI
                } else {
                    // –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏ (–æ—à–∏–±–∫–∞ API, –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON –∏ —Ç.–¥.)
                    // –ü–æ–ø—ã—Ç–∫–∞ —Ç–∞–∫–∂–µ –ù–ï –ë–´–õ–ê —Å–ø–∏—Å–∞–Ω–∞.
                    showCustomAlert(t.alert_api_error); 
                }
                // ---------------------------------------------

                 // –°–±—Ä–æ—Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏
                 isAnalyzing = false;
                 analyzeButton.innerHTML = t.analyzeButton;
                 tryAgainButton.disabled = false;
                 gameTypeSelect.disabled = false;
                 analyzeButton.style.marginBottom = '';
                 analysisContainer.classList.add('hidden');
                 updateAnalyzeButtonState(); // –û–±–Ω–æ–≤–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ (–±—É–¥–µ—Ç –∞–∫—Ç–∏–≤–Ω–∞, –µ—Å–ª–∏ –ø–æ–ø—ã—Ç–∫–∏ > 0)

            } finally {
                clearTimeout(timeoutId); 
                clearInterval(analysisInterval); 
                console.log("--- Analysis process finished ---");
            }
        }

// --- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –∞–Ω–∞–ª–∏–∑–∞ ---
    analyzeButton.onclick = analyzeBet;

    // --- –§—É–Ω–∫—Ü–∏—è "–ø—Ä–æ–≥—Ä–µ–≤–∞" –±—ç–∫–µ–Ω–¥–∞ ---
    async function pingBackend() {
        if (!userId) return; 
        console.log("Pinging backend to potentially bypass ngrok warning...");
        try {
            fetch(`${BACKEND_URL}/`, { 
                 method: 'GET',
                 cache: 'no-cache',
                 headers: {
                    'ngrok-skip-browser-warning': 'true'
                 }
             }).catch(err => {
                 console.log("Ping request finished (errors ignored).");
             });
        } catch (error) {
             console.log("Ping request failed (error ignored).");
        }
    }
    
    // --- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö ---
    function startAppLoad() {
         pingBackend(); 
         setTimeout(() => {
             loadInitialAttempts(); 
         }, 150); 
    }

    // --- –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–ø–æ–ø—ã—Ç–æ–∫) ---
    async function loadInitialAttempts() { 
         // –û—á–∏—â–∞–µ–º —Ç–∞–π–º–µ—Ä –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π
         if (countdownInterval) {
             clearInterval(countdownInterval);
             countdownInterval = null;
         }
         cooldownEndTime = null; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫—É–ª–¥–∞—É–Ω
        
         const t = translations[currentLang] || translations['ru'];
         attemptsTextElement.textContent = t.attemptsTextLoading; 
         attemptsTextElement.classList.remove('attempts-error');
         console.log(`Requesting attempts from ${BACKEND_URL} for user ${userId} (partner: ${currentPartner})`);

         try {
             const response = await fetch(`${BACKEND_URL}/get_attempts?user_id=${userId}&partner=${currentPartner}`, {
                 method: 'GET',
                 cache: 'no-cache', 
                 headers: {
                    'ngrok-skip-browser-warning': 'true'
                 }
             });
             if (!response.ok) {
                  console.error(`Failed to load attempts: ${response.status}`);
                  throw new Error(`HTTP error ${response.status}`);
             }
             const data = await response.json(); 
             console.log("Attempts and lang loaded:", data);

             if (typeof data.attempts_left === 'number') {
                 attemptsLeft = data.attempts_left;
                 cooldownEndTime = data.cooldown_end_iso || null;
                 
                 // –ò–ó–ú–ï–ù–ï–ù–ò–ï: –°–æ—Ö—Ä–∞–Ω—è–µ–º –º–æ–¥–µ–ª—å –æ–ø–ª–∞—Ç—ã, –ø–æ–ª—É—á–µ–Ω–Ω—É—é —Å —Å–µ—Ä–≤–µ—Ä–∞
                 if (data.payment_model) {
                     currentPaymentModel = data.payment_model;
                     console.log("Payment model set to:", currentPaymentModel);
                 }
                 
                 // –û–ü–†–ï–î–ï–õ–Ø–ï–ú –Ø–ó–´–ö
                 if (data.lang && translations[data.lang]) {
                     currentLang = data.lang;
                     console.log("Language set from server:", currentLang);
                 } else {
                     console.log("No valid language from server, using default:", currentLang);
                 }
                 
                 // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –®–∞–≥ 1. –°–Ω–∞—á–∞–ª–∞ –ø—Ä–∏–º–µ–Ω—è–µ–º —è–∑—ã–∫ –∫–æ –≤—Å–µ–º—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É.
                 // –í —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ç–æ–∂–µ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—Å—è, –Ω–æ –µ—â—ë —Å–∫—Ä—ã—Ç–æ.
                 setLanguage(currentLang);
                 
                 // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –®–∞–≥ 2. –¢–æ–ª—å–∫–æ —Ç–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä—è–µ–º, –Ω—É–∂–Ω–æ –ª–∏ –ø–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ.
                 const agreementKey = `agreement_accepted_${currentPartner}`;
                 const isAgreementAccepted = localStorage.getItem(agreementKey);
            
                 if (isAgreementAccepted !== 'true') {
                     // –¢–µ–ø–µ—Ä—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ—è–≤–∏—Ç—Å—è —É–∂–µ –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —è–∑—ã–∫–µ.
                     agreementModal.classList.add('show');
                 }

             } else {
                  throw new Error("Invalid 'attempts_left' format in response");
             }
         } catch (error) {
             console.error('Failed to load initial attempts:', error);
             attemptsLeft = -1; 
             cooldownEndTime = null;
             
             // –ü—Ä–∏–º–µ–Ω—è–µ–º —è–∑—ã–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏
             setLanguage(currentLang); 
             const t = translations[currentLang] || translations['ru'];
             attemptsTextElement.textContent = t.attemptsTextError; 
             attemptsTextElement.classList.add('attempts-error'); 
             updateAnalyzeButtonState();
             
             // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ, –µ—Å–ª–∏ –æ–Ω–æ –Ω–µ –ø—Ä–∏–Ω—è—Ç–æ.
             const agreementKey = `agreement_accepted_${currentPartner}`;
             if (localStorage.getItem(agreementKey) !== 'true') {
                agreementModal.classList.add('show');
             }
         }
     }


    // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã ---
    document.addEventListener('DOMContentLoaded', () => {
        tg.ready();

        const urlParams = new URLSearchParams(window.location.search);
        userId = urlParams.get('user_id'); 

        if (!userId && tg.initDataUnsafe && tg.initDataUnsafe.user) {
             userId = tg.initDataUnsafe.user.id?.toString();
        }

        const partnerFromUrl = urlParams.get('partner');
        if (partnerFromUrl === 'mostbet' || partnerFromUrl === '1win') {
            currentPartner = partnerFromUrl; 
        }
        
        console.log("User ID:", userId, "Partner:", currentPartner); 

        // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Å—Ç–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —è–∑—ã–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ "–ø—É—Å—Ç–æ–≥–æ —ç–∫—Ä–∞–Ω–∞".
        // –õ–æ–≥–∏–∫–∞ –ø–æ–∫–∞–∑–∞ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –≤ loadInitialAttempts.
        setLanguage(currentLang); 
        
        if (userId) {
            // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Å —Å–µ—Ä–≤–µ—Ä–∞.
            startAppLoad();
        } else {
             // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ª—É—á–∞—è, –∫–æ–≥–¥–∞ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –Ω–∞–π–¥–µ–Ω
             console.error("User ID not found in URL or initDataUnsafe.");
             attemptsLeft = -1; 
             const t = translations[currentLang] || translations['ru'];
             attemptsTextElement.textContent = t.attemptsTextError;
             attemptsTextElement.classList.add('attempts-error');
             updateAnalyzeButtonState(); 
        }
        
        // --- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Å–∞–º–æ–≥–æ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ ---
        document.querySelector('.custom-checkbox').addEventListener('click', () => {
            agreementCheckbox.checked = !agreementCheckbox.checked;
            agreementCheckbox.dispatchEvent(new Event('change')); 
        });
        
        agreementCheckbox.addEventListener('change', () => {
            agreementButton.disabled = !agreementCheckbox.checked;
        });
        
        agreementButton.addEventListener('click', () => {
            if (agreementCheckbox.checked) {
                const agreementKey = `agreement_accepted_${currentPartner}`;
                localStorage.setItem(agreementKey, 'true');
                agreementModal.classList.remove('show');
            } else {
                showCustomAlert((translations[currentLang] || translations['ru']).alert_agreement_required);
            }
        });
        
    });

</script>
</body>
</html>